---
title: "Modelos de ecuaciones estructurales"
author: "Federico D√≠az Recart"
subtitle: "[https://github.com/fedediazr/Clase-SEM-fdr](https://github.com/fedediazr/Clase-SEM-fdr)"
format: revealjs
editor: visual
---

## Contenidos

<div style="font-size: 0.85em;">

-   Introducci√≥n

-   Modelo de medici√≥n

    -   Error de medici√≥n
    -   Variable latente
    -   CFA (An√°lisis factorial confirmatorio)

-   Modelo estructural

    -   Path analysis (Variables observadas)
    -   Modelo de ecuaciones estructurales: Combinaci√≥n entre modelo de medici√≥n y modelo estructural

## Introducci√≥n: ¬øQu√© es SEM?

M√°s que una t√©cnica, los modelos de ecuaciones estructurales son una familia de m√©todos que combinan:

1)  **Modelos de medici√≥n**: Permiten medir y evaluar como se relacionan un conjunto de variables observadas y si estas miden un constructo te√≥rico de inter√©s

2)  **Modelos estructurales**: Permite evaluar si un conjunto de constructos se relacionan seg√∫n un modelo te√≥rico propuesto

Es un conjunto de m√©todos comprensivos para la cuantificaci√≥n y testeo de **teor√≠as sustantivas**

## Ejemplo: Normas sociales y polarizaci√≥n

![Gonz√°lez, R., D√≠az, F., Fuenzalida, D., √Ålvarez, A., Lay, S., Carvacho, H., & Manzi, J. (2025, May 22--23). Social norms and affective polarization in political contexts \[Conference presentation\]. Interdisciplinary Conference on Social Norms, Cohesion, and (De)Polarization, Utrecht, Netherlands.](Ejemplo%20SEM.png)

## 1: Modelo de medici√≥n {.center}

## Error de medici√≥n

Una de las caracter√≠sticas m√°s importantes de los modelos SEM es que **toman en cuenta el error de medici√≥n**.

Dos fuentes de error en encuestas: Medici√≥n (c√≥mo se mide el fen√≥meno) y Representaci√≥n (a qui√©nes se logra medir).

-   Medici√≥n: El constructo te√≥rico que se quiere medir se transforma en preguntas (operacionalizaci√≥n). Las respuestas pueden verse afectadas por problemas de validez, error de medici√≥n y error de procesamiento.

## Error de medici√≥n

-   Representaci√≥n: Desde la poblaci√≥n objetivo se define una poblaci√≥n inferencial, un marco muestral y una muestra. En cada paso pueden surgir errores de cobertura, muestreo y no respuesta.

Modelos SEM nos permiten separar la varianza asociada al puntaje "real" de un constructo de la varianza asociada a error de medici√≥n.

## Error de medici√≥n

![Total survey error approach](error.png)

## Error de medici√≥n

Por lo tanto, indicadores individuales pueden ser insuficientes para medir conceptos complejos, especialmente en ciencias sociales:

-   Clase social
-   Confianza social
-   Actitudes hacia la democracia
-   Actitudes punitivas
-   Creencia en conspiraciones
-   Bienestar subjetivo

## Variable latente

¬øC√≥mo los modelos SEM corrigen el error de medici√≥n?

-   SEM utiliza variables latentes (constructos no observados, p. ej., inteligencia).

-   Estas se estiman a partir de m√∫ltiples variables observadas (√≠tems, puntajes).

-   Separa la parte confiable (puntaje verdadero) del error de medici√≥n.

-   Modela relaciones entre constructos libres de error. Entregando estimaciones menos sesgadas que usar variables observadas directamente.

## Variable latente

¬øQu√© es una variable latente?

-   Constructos te√≥ricos no observados y que no pueden ser medidos directamente pero que existen

-   Son "inferidas" a trav√©s de m√∫ltiples variables que act√∫an como manifestaciones del constructo.

-   Por ejemplo, no podemos medir directamente depresi√≥n, pero podemos aproximarnos a trav√©s de la medici√≥n de distintos s√≠ntomas (PHQ9).

## Variable latente

![](latent%20variable.jfif)

## An√°lisis factorial confirmatorio

-   T√©cnica multivariante de an√°lisis de interdependencia entre variables
-   Permite estudiar interrelaci√≥n de un n√∫mero de variables **observadas**
-   Estas variables se agrupan en un n√∫mero reducido de factores (variable latente)
-   Validaci√≥n de instrumentos
-   Derivaci√≥n de puntajes

## An√°lisis factorial confirmatorio

Ejemplo aplicado: ¬øCorresponden las normas descriptivas pro contacto y las normas prescriptivas pro contacto a dos dimensiones distintas?

![](CFA.png)

## Variables

<div style="font-size: 0.7em;">

Indique el grado de acuerdo o desacuerdo con las siguientes afirmaciones

-   Las personas de **\[INGROUP\]** que conozco valorar√≠an que yo tenga amistades de **\[OUTGROUP\]**.
-   Las personas de **\[INGROUP\]** que conozco me estimulan a que me junte con personas de **\[OUTGROUP\]**.
-   Las personas de **\[INGROUP\]** que conozco valorar√≠an que yo colabore con personas de **\[OUTGROUP\]**.
-   Es com√∫n que las personas de **\[INGROUP\]** tengan amistades de **\[OUTGROUP\]**.
-   Con frecuencia las personas de **\[INGROUP\]** se juntan con personas de **\[OUTGROUP\]**.
-   Con frecuencia las personas de **\[INGROUP\]** colaboran con personas de **\[OUTGROUP\]**.

## Pasos

1)  Especificaci√≥n del modelo
2)  Evaluaci√≥n de ajuste
3)  Cargas factoriales

## Especificaci√≥n del modelo

<div style="font-size: 0.85em;">

```{r, echo=TRUE}
load("Base_polarizacion_escalas.Rdata")
library(lavaan)
cfa <- '

# -----------------------------------------------
# Variables latentes
# -----------------------------------------------
norm_descr_pro_cont =~ Q10_1 + Q10_2 + Q10_3 
norm_pres_pro_cont =~ Q15_1 + Q15_2 + Q15_3

# Covarianza
norm_descr_pro_cont ~~ norm_pres_pro_cont
'

fit_cfa <- cfa(cfa, data = df)
```

-   el operador =\~ significa "es manifestado por"
-   Tenemos 2 variables latentes, manifestadas por 3 items cada una
-   Para ajustar el modelo utilizamos el comando cfa

## Ajuste del modelo

```{r, echo=TRUE}
fitMeasures(fit_cfa, c("chisq", "df", "pvalue", "cfi", "rmsea", "tli"))
```

-   œá¬≤ (p \< .05): indica discrepancia significativa, pero es sensible al tama√±o muestral.
-   CFI (.978): muy buen ajuste del modelo.
-   TLI (.958): buen ajuste, penaliza complejidad.
-   RMSEA (.084): ajuste aceptable--lim√≠trofe.

Conclusi√≥n: ajuste global bueno, pese al œá¬≤ significativo.

## Cargas factoriales

<div style="font-size: 0.85em;">

-   Las cargas factoriales indican qu√© tan fuertemente cada √≠tem observado est√° asociado con el factor latente que pretende medir.
-   Es el coeficiente de regresi√≥n que indica cu√°nto cambia el √≠tem cuando el factor aumenta una unidad.

```{r, echo=TRUE}
loadings <- inspect(fit_cfa, what = "std")$lambda
loadings
```

-   Todas son altas (‚âà .71--.92), indicando que los √≠tems representan bien sus factores latentes.

## 2: Modelo estructural {.center}

## Path analysis (An√°lisis de senderos)

-   Es un modelo de relaciones de dependencia entre varias variables
-   Utiliza variables observadas o promedios de √≠temes
-   No eval√∫a un modelo de medici√≥n

[![Caughlin, D. E. (2022). R for HR: An introduction to human resource analytics using R.](PathModel.png)](https://rforhr.com/sem.html)

## Path analysis (An√°lisis de senderos)

-   Es una extensi√≥n de la regresi√≥n lineal
-   Incorpora varias regresiones en un mismo modelo, permitiendo evaluar
    -   Efectos directos
    -   Efectos indirectos
    -   Mediaci√≥n y efectos totales

## Path analysis (An√°lisis de senderos)

### Supuestos

-   Tama√±o de muestra grande: Al menos 10 a 20 casos por parametro, idealmente N\>200
-   Relaciones lineales entre variables
-   Identificaci√≥n del modelo basado en teor√≠a
-   Variables continuas

## Modelo de ecuaciones estructurales

-   Combinan modelo de medici√≥n y modelo estructural
-   Hoy nos vamos a fijar en modelos que combinan an√°lisis de senderos con an√°lisis factorial confirmatorio
-   En s√≠ntesis: An√°lisis de senderos de variables latentes y observadas
-   Estos modelos son tambi√©n llamados modelos MIMIC (Multiple Indicators Multiple Causes)

## Modelo de ecuaciones estructurales
### Efecto directo, indirecto y total

-  Efecto directo: influencia de una variable sobre otra sin mediadores (por ejemplo, ùëã‚Üíùëå

-  Efecto indirecto: influencia de una variable sobre otra que ocurre a trav√©s de una o m√°s variables mediadoras (por ejemplo, ùëã‚ÜíùëÄ‚Üíùëå)
    -  Matem√°ticamente, es el producto de los coeficientes de los caminos
    involucrados (ej.: ùëé√óùëè)
-  Efecto total: efecto global de una variable sobre otra, que combina todas las v√≠as posibles.

## Modelo de ecuaciones estructurales
### Supuestos

-   Tama√±o de muestra grande: Al menos 10 a 20 casos por parametro, idealmente N\>200
-   Relaciones lineales entre variables
-   Identificaci√≥n del modelo basado en teor√≠a
-   Variables continuas

## Modelo de ecuaciones estructurales

### Especificaci√≥n del modelo

Cupani (2012) sugiere varias estrategias posibles:

1)  Modelizaci√≥n confirmatoria: Se especifica un solo modelo alineado con lo que se espera te√≥ricamente.

2)  Modelos rivales: Se especifican varios modelos distintos para que "compitan" en t√©rminos de ajuste

3)  Desarrollo del modelo: Se parte de un modelo simple y se va mejorando, ya sea el modelo de medici√≥n o las relaciones estructurales entre variables

## Modelo de ecuaciones estructurales

### Evaluaci√≥n del ajuste

Igual que en los modelos CFA

-   Chi cuadrado
-   RMSEA
-   CFI

## Modelo de ecuaciones estructurales

### Interpretaci√≥n de resultados

-   Coeficientes beta no estandarizados: Efecto que cada aumento en una unidad de la variable independiente tiene en la dependiente
-   Coeficientes beta estandarizados: Efectos que cada aumento en una desviaci√≥n est√°ndar de la variable independiente tiene en la dependiente (en t√©rminos de desviaciones est√°ndar)
-   Significaci√≥n de cada coeficiente: p\<0,05, rechazamos hip√≥tesis nula de que el beta es igual a 0 a un 95% de confianza

## Ejemplo aplicado

![Gonz√°lez, R., D√≠az, F., Fuenzalida, D., √Ålvarez, A., Lay, S., Carvacho, H., & Manzi, J. (2025, May 22--23). Social norms and affective polarization in political contexts \[Conference presentation\]. Interdisciplinary Conference on Social Norms, Cohesion, and (De)Polarization, Utrecht, Netherlands.](Ejemplo%20SEM.png)

## Ejemplo aplicado
### Variables
<div style="font-size: 0.9em;">

-  Normas prescriptivas pro contacto (ej: "Las personas de [INGROUP] que conozco valoran tener amistades con gente de [OUTGROUP])
-  Normas descriptivas pro contacto (ej: "Es com√∫n que las personas de [INGROUP] tengan  amistades de [OUTGROUP])
-  Contacto intergrupal (ej: ¬øCon qu√© frecuencia interact√∫a con personas de [OUTGROUP])
-  Polarizaci√≥n ideol√≥gica: Medida como la distancia del punto medio en una serie de problem√°ticas (Aborto, conflicto ind√≠gena, rol estado vs empresa)


## Especificaci√≥n del modelo

```{r, echo=TRUE}
m1 <- '

## -----------------------------------------------
# Variables latentes
# -----------------------------------------------
norm_descr_c =~ Q10_1 + Q10_2 + Q10_3
norm_prescr_c =~ Q15_1 + Q15_2 + Q15_3
contact =~ Cantidad_contacto + Contacto_positivo

# -----------------------------------------------
# Relaciones estructurales (Mediaci√≥n)
# -----------------------------------------------
# Efecto de normas descriptivas y prescriptivas sobre contact (a)
contact ~ a*norm_descr_c + a2*norm_prescr_c

# Efecto de contact sobre polarizaci√≥n (b)
id_pol ~ b*contact + c*norm_descr_c + c2*norm_prescr_c

# Covarianza
norm_descr_c ~~ norm_prescr_c

# Covarianza items
Q10_1 ~~ Q15_1
Q10_2 ~~ Q15_2
Q10_3 ~~ Q15_3

# -----------------------------------------------
# Efectos definidos (Indirecto y Total)
# -----------------------------------------------
indirect1 := a*b
indirect3 := a2*b

total1 := a * b + c
total3 := a2 * b + c2
'

fit_m1 <- sem(m1, data = df, missing="FIML")
```

## Interpretaci√≥n de resultados

```{r, echo=TRUE}
summary(fit_m1, fit.measures = TRUE, standardized = TRUE)
```

# ¬°Gracias! {.center}

fdr@alumni.uc.cl
